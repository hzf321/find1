{"version":3,"sources":["assets/script/loading.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { gameData, storage } from \"./tool/gameData\";\nimport { Global } from \"./tool/global\";\nimport { StorageUtils } from \"./tool/StorageUtils\";\nimport { dialog, scene, UtilsTool } from \"./tool/utils\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class loading extends cc.Component {\n\n    @property(cc.Node)\n    loading_bg: cc.Node = null;\n\n    @property(cc.Sprite)\n    loaging_bar_yellow: cc.Sprite = null;\n\n    @property(cc.Node)\n    loadingBox: cc.Node = null;\n\n    @property(cc.Node)\n    gotoHallBox: cc.Node = null;\n\n    @property(cc.Node)\n    loading_play: cc.Node = null;\n\n    private resNum = 6;\n    private nowNum = 0;\n\n    start() {\n\n        if (cc.sys.platform === cc.sys.IPAD) {\n            this.getComponent(cc.Canvas).fitHeight = true;\n            this.getComponent(cc.Canvas).fitWidth = false;\n        }\n\n\n        UtilsTool.adapterBg(this.loading_bg);\n        Global.audioUtils.initBtnClickEffect();\n        Global.audioUtils.initbgmMusic();\n\n        let gamedataStorage = StorageUtils.getStorageJSON(storage.gamedata);\n        if (gamedataStorage) {\n            gameData.userData = gamedataStorage;\n        }\n\n        Global.setsceneNode(this.node);\n\n\n        if (!gameData.userData.isClause) {\n            this.gotoHallBox.active = false;\n            this.loadingBox.active = false;\n            Global.assetUtils.showDialog(dialog.clause_dialog, {\n                callback: () => {\n                    gameData.userData.isClause = true;\n                    this.gotoHallBox.active = true;\n                    this.loadingBox.active = false;\n                    gameData.storageData();\n                    cc.tween(this.loading_play).to(0.5, { scale: 1.1 }).to(0.5, { scale: 1 }).union().repeatForever().start();\n                }\n            });\n        } else {\n            this.gotoHallBox.active = true;\n            this.loadingBox.active = false;\n\n            cc.tween(this.loading_play).to(0.5, { scale: 1.1 }).to(0.5, { scale: 1 }).union().repeatForever().start();\n        }\n\n\n\n        gameData.setVideoFailCb(()=>{\n            cc.resources.load(\"prefeb/toast\", cc.Prefab, (err, prefab) => {\n                if (err) {\n                    return;\n                }\n                let toast = cc.instantiate(prefab);\n                Global.assetUtils.bindAutoReleaseAsset(toast, prefab);\n                let parentNode = Global.getsceneNode();\n                if (toast && parentNode) {\n                    toast.active = true;\n                    parentNode.addChild(toast);\n                    let toastLabel = toast.getChildByName(\"label\");\n                    toastLabel.getComponent(cc.Label).string = \"No ads at the moment\";\n                    cc.Tween.stopAllByTarget(toast);\n                    toast.opacity = 255;\n                    cc.tween(toast).to(0.15, { scale: 1.2 }).to(0.15, { scale: 1 }).delay(0.5).to(0.5, { opacity: 0 }).call(() => {\n                        toast.destroy();\n                    }).start();\n                }\n            })\n        });\n \n\n    }\n\n    onClick_gotoPlay() {\n        this.gotoHallBox.active = false;\n        this.loadingBox.active = true;\n        Global.audioUtils.commonBtnClick();\n\n        this.loaging_bar_yellow.fillRange = 0;\n        cc.Tween.stopAllByTarget(this.loaging_bar_yellow)\n        cc.loader.loadResDir(\"prefeb\", (err, assets) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            console.log('prefeb assets in  have been loaded.');\n            this.progressBarEvent();\n        });\n        cc.loader.loadResDir(\"finishImg\", (err, assets) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            console.log('finishImg assets in  have been loaded.');\n            this.progressBarEvent();\n        });\n        cc.loader.loadResDir(\"originalImg\", (err, assets) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            console.log('originalImg assets in  have been loaded.');\n            this.progressBarEvent();\n        });\n        cc.loader.loadResDir(\"imgJson\", (err, assets) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            gameData.levelAll = assets.length;\n            console.log('imgJson assets in  have been loaded.');\n            this.progressBarEvent();\n        });\n\n        cc.director.preloadScene(scene.game, (err, assets) => {\n            cc.log(\"game scene preloaded\");\n            this.progressBarEvent();\n        });\n        cc.director.preloadScene(scene.hall, (err, assets) => {\n            cc.log(\"hall scene preloaded\");\n            this.progressBarEvent();\n        });\n\n    }\n\n    progressBarEvent() {\n        let fill = 1 / 6;\n        this.nowNum++;\n        cc.Tween.stopAllByTarget(this.loaging_bar_yellow)\n        cc.tween(this.loaging_bar_yellow).to(0.5, { fillRange: fill * this.nowNum })\n            .call(() => {\n                if (this.nowNum == this.resNum) {\n                    this.scheduleOnce(() => {\n                        if (gameData.userData.isHall) {\n                            cc.director.loadScene(scene.hall);\n                        } else {\n                            Global.imgId = gameData.userData.level;\n                            cc.director.loadScene(scene.game);\n                        }\n                    }, 0.05)\n                }\n            }).start();\n    }\n\n\n    showShiPing() {\n        console.log(\"android---------------showShiPing------------------\")\n        gameData.showVideo(()=>{\n            console.log(\"zzzzzzzzzzzzzzzzzzzzwwwwwwwwwwwwwwwwwwwwwwwwwwwww\");\n          })\n    }\n\n\n    showbanner() {\n        console.log(\"android---------------showbanner------------------\")\n        jsb.reflection.callStaticMethod(\"UnityMgr\", \"showbanner\", \"()V\");\n    }\n\n\n    hidebanner() {\n        console.log(\"android---------------hidebanner------------------\")\n        jsb.reflection.callStaticMethod(\"UnityMgr\", \"hidebanner\", \"()V\");\n    }\n \n    showChaping() {\n        console.log(\"android---------------showChaping------------------\")\n        jsb.reflection.callStaticMethod(\"UnityMgr\", \"loadInterstitial\", \"()V\");\n    }\n   \n    testBtn() {\n        console.log(\"android---------------testBtn------------------\")\n        //jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"openPingFen\", \"()V\");\n    \n        jsb.reflection.callStaticMethod(\"UnityMgr\", \"testlog\");//全屏视频\n    }\n}\n"]}